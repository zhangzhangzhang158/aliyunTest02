{"version":3,"file":"src_app_pages_redirect_redirect_module_ts.js","mappings":";;;;;;;;;;;;;;;;;;;;AACA;AACA;;;AAEA,IAAME,MAAM,GAAW,CACrB;AACEC,MAAI,EAAE,EADR;AAEEC,WAAS,EAAEH,kEAAiBA;AAF9B,CADqB,CAAvB;AAWO,IAAMI,qBAAb;AAAA;AAAA;;;mBAAaA;AAAqB;;;QAArBA;;;YAHF,CAACL,kEAAA,CAAsBE,MAAtB,CAAD,GACCF,yDAAYA;;;;sHAEXK,uBAAqB;AAAAE,cAAAA,yDAAAA;AAAAC,cAFtBR,yDAEsB;AAAA;AAFV;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACQjB,IAAMC,iBAAb;AAGE,6BACUQ,IADV,EAEUC,MAFV,EAGUC,YAHV,EAIUC,WAJV,EAKUC,YALV,EAMUC,gBANV,EAOUC,WAPV,EAOkC;AAAA;;AANxB;AACA;AACA;AACA;AACA;AACA;AACA;AACN;;AAXN;AAAA;AAAA,WAaE,oBAAQ;AACNC,aAAO,CAACC,GAAR,CAAY,+BAAZ;AACD;AAfH;AAAA;AAAA,WAiBE,2BAAe;AAAA;;AACbD,aAAO,CAACC,GAAR,CAAY,sCAAZ;;AACA,UAAI,KAAKL,WAAL,CAAiBM,QAAjB,CAA0BC,cAA1B,GAA2CC,MAA3C,GAAoD,CAAxD,EAA2D;AACzDJ,eAAO,CAACC,GAAR,CAAY,KAAKL,WAAL,CAAiBM,QAAjB,CAA0BC,cAA1B,EAAZ;AACA,YAAME,OAAO,GAAG,KAAKT,WAAL,CAAiBM,QAAjB,CAA0BC,cAA1B,GAA2C,CAA3C,EAA8CG,QAA9D;AAEA,aAAKX,YAAL,CAAkBY,MAAlB;AACA,aAAKZ,YAAL,CAAkBa,QAAlB,CAA2BH,OAA3B,EAAoCI,SAApC,CAA8C;AAC5CC,cAAI,EAAE,cAACC,OAAD,EAAY;AAChB,gBAAIA,OAAJ,EAAa;AACXX,qBAAO,CAACC,GAAR,CAAY,kBAAZ;;AACA,mBAAI,CAACN,YAAL,CAAkBiB,OAAlB,GAA4BH,SAA5B,CAAsC;AACpCC,oBAAI,EAAE,cAACG,QAAD,EAAa;AACjB,sBAAIA,QAAJ,EAAc;AACZb,2BAAO,CAACC,GAAR,CAAY,kBAAZ;AACA,wBAAMa,QAAQ,GAAGC,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAjB;AACAD,gCAAY,CAACE,UAAb,CAAwB,UAAxB;;AACA,wBAAI,CAAC,CAACH,QAAN,EAAgB;AACd,2BAAI,CAACf,WAAL,CAAiBmB,QAAjB,GAA4BT,SAA5B,CAAsC;AACpCC,4BAAI,EAAE,cAACS,KAAD,EAAU;AACdJ,sCAAY,CAACK,OAAb,CAAqB,OAArB,EAA8BC,IAAI,CAACC,SAAL,CAAeH,KAAf,CAA9B;AACD,yBAHmC;AAIpC;AACAI,gCAAQ,EAAE,oBAAK;AACb,+BAAI,CAAC7B,MAAL,CAAY8B,aAAZ,CAA0BV,QAA1B;AACD;AAPmC,uBAAtC;AASD,qBAVD,MAUO;AACL,2BAAI,CAACpB,MAAL,CAAY+B,QAAZ,CAAqB,CAAC,GAAD,CAArB;AACD;AACF;AACF;AApBmC,eAAtC;AAsBD,aAxBD,MAwBO;AACLzB,qBAAO,CAACC,GAAR,CAAY,eAAZ;AACD;AACF,WA7B2C;AA8B5CyB,eAAK,EAAE,eAACC,CAAD,EAAM;AACX3B,mBAAO,CAACC,GAAR,CAAY0B,CAAZ;AACD;AAhC2C,SAA9C;AAkCD,OAvCD,MAuCO;AACL,aAAK9B,YAAL,CAAkB6B,KAAlB,CACE,KAAK5B,gBAAL,CAAsB8B,OAAtB,CAA8B,8BAA9B,CADF;AAGD;AACF;AA/DH;;AAAA;AAAA;;;mBAAa3C,mBAAiB4C,+DAAAA,CAAAA,4DAAAA,GAAAA,+DAAAA,CAAAA,mDAAAA,GAAAA,+DAAAA,CAAAA,6EAAAA,GAAAA,+DAAAA,CAAAA,4DAAAA,GAAAA,+DAAAA,CAAAA,6EAAAA,GAAAA,+DAAAA,CAAAA,iEAAAA,GAAAA,+DAAAA,CAAAA,2EAAAA;AAAA;;;QAAjB5C;AAAiB6C;AAAAC;AAAAC;AAAAC;AAAA;ACrB9BJ,MAAAA,4DAAAA;AAAGA,MAAAA,oDAAAA;AAAUA,MAAAA,0DAAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACCb;AACA;AACA;AACA;AACA;AACA;;AAaO,IAAMU,cAAb;AAAA;AAAA;;;mBAAaA;AAAc;;;QAAdA;;;YAVF,CACPL,yDADO,EAEPC,uDAFO,EAGPC,+DAHO,EAIPC,kEAJO,EAKPhD,2EALO,EAMPiD,gEANO;;;;sHAUEC,gBAAc;AAAAC,mBAFVvD,kEAEU;AAFOM,cAP9B2C,yDAO8B,EAN9BC,uDAM8B,EAL9BC,+DAK8B,EAJ9BC,kEAI8B,EAH9BhD,2EAG8B,EAF9BiD,gEAE8B;AAEP;AAJR","sources":["../../teams%E6%96%87%E4%BB%B6%E8%B5%84%E6%96%99/rma-web/src/app/pages/redirect/redirect-routing.module.ts","../../teams%E6%96%87%E4%BB%B6%E8%B5%84%E6%96%99/rma-web/src/app/pages/redirect/redirect.component.ts","../../teams%E6%96%87%E4%BB%B6%E8%B5%84%E6%96%99/rma-web/src/app/pages/redirect/redirect.component.html","../../teams%E6%96%87%E4%BB%B6%E8%B5%84%E6%96%99/rma-web/src/app/pages/redirect/redirect.module.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { RedirectComponent } from './redirect.component';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: RedirectComponent\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class RedirectRoutingModule { }\r\n","import { Component, OnInit, AfterViewInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { MsalService } from '@azure/msal-angular';\r\nimport { MenuService } from 'src/app/core/services/menu.service';\r\nimport { LoginService } from 'src/app/core/services/login.service';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { ToastService } from 'src/app/core/services/toast.service';\r\nimport { TranslateService } from '@ngx-translate/core';\r\n\r\ntype ProfileType = {\r\n  givenName?: string;\r\n  surname?: string;\r\n  userPrincipalName?: string;\r\n  id?: string;\r\n};\r\n\r\n@Component({\r\n  selector: 'app-redirect',\r\n  templateUrl: './redirect.component.html',\r\n  styleUrls: ['./redirect.component.scss'],\r\n})\r\nexport class RedirectComponent implements OnInit, AfterViewInit {\r\n  profile!: ProfileType;\r\n\r\n  constructor(\r\n    private http: HttpClient,\r\n    private router: Router,\r\n    private loginService: LoginService,\r\n    private msalService: MsalService,\r\n    private toastService: ToastService,\r\n    private translateService: TranslateService,\r\n    private menuService: MenuService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    console.log('redirect.component.ngOnInit()');\r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n    console.log('redirect.component.ngAfterViewInit()');\r\n    if (this.msalService.instance.getAllAccounts().length > 0) {\r\n      console.log(this.msalService.instance.getAllAccounts());\r\n      const account = this.msalService.instance.getAllAccounts()[0].username;\r\n\r\n      this.loginService.logout();\r\n      this.loginService.loginAad(account).subscribe({\r\n        next: (success) => {\r\n          if (success) {\r\n            console.log('loginAad success');\r\n            this.loginService.profile().subscribe({\r\n              next: (success2) => {\r\n                if (success2) {\r\n                  console.log('profile success2');\r\n                  const location = localStorage.getItem('location');\r\n                  localStorage.removeItem('location');\r\n                  if (!!location) {\r\n                    this.menuService.getMenus().subscribe({\r\n                      next: (menus) => {\r\n                        localStorage.setItem('menus', JSON.stringify(menus));\r\n                      },\r\n                      // error: () => {},\r\n                      complete: () => {\r\n                        this.router.navigateByUrl(location);\r\n                      },\r\n                    });\r\n                  } else {\r\n                    this.router.navigate(['/']);\r\n                  }\r\n                }\r\n              },\r\n            });\r\n          } else {\r\n            console.log('loginAad fail');\r\n          }\r\n        },\r\n        error: (e) => {\r\n          console.log(e);\r\n        },\r\n      });\r\n    } else {\r\n      this.toastService.error(\r\n        this.translateService.instant('message.failed-to-fetch-data')\r\n      );\r\n    }\r\n  }\r\n}\r\n","<p>loading...</p>\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { FlexLayoutModule } from '@angular/flex-layout';\r\nimport { RedirectRoutingModule } from './redirect-routing.module';\r\nimport { RedirectComponent } from './redirect.component';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    FlexLayoutModule,\r\n    RedirectRoutingModule,\r\n    TranslateModule\r\n  ],\r\n  declarations: [RedirectComponent]\r\n})\r\nexport class RedirectModule { }\r\n"],"names":["RouterModule","RedirectComponent","routes","path","component","RedirectRoutingModule","forChild","imports","exports","http","router","loginService","msalService","toastService","translateService","menuService","console","log","instance","getAllAccounts","length","account","username","logout","loginAad","subscribe","next","success","profile","success2","location","localStorage","getItem","removeItem","getMenus","menus","setItem","JSON","stringify","complete","navigateByUrl","navigate","error","e","instant","i0","selectors","decls","vars","template","CommonModule","FormsModule","ReactiveFormsModule","FlexLayoutModule","TranslateModule","RedirectModule","declarations"],"sourceRoot":"webpack:///"}